
function [W, pplus, pminus, gammaminus]= ...
        PMM_eig_for_Maxwell(L_full,verbose)
    if (verbose>5)
        title = 'enter PMM-eig'
    end
    
    %{
    [EH, gamma_norm] = eig(M);
    
    gamma_v = diag(gamma_norm);
    gamma = gamma_norm*k0;
    
    NN = N_total_3;
    
    gammaplus = zeros(2*NN,1);
    gammaminus = zeros(2*NN,1);
    EHplus = zeros(4*NN,2*NN);
    EHminus = zeros(4*NN,2*NN);
    nplus = 0;
    nminus = 0;
    
    for i=1:4*NN
        
        if ( real(gamma(i,i))+imag(gamma(i,i)) )>0
            nplus = nplus + 1;
            gammaplus(nplus) = gamma(i,i);
            EHplus(:,nplus) = EH(:,i);
        else
            nminus = nminus + 1;
            gammaminus(nminus) = gamma(i,i);
            EHminus(:,nminus) = EH(:,i);
        end
    end
    
    W = cat(2, EHplus, EHminus);
    %}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    L_full = L_HE*L_EH;
    [H_1_4, gamma_sqr_1_4] = eig(L_full);
    
    gamma_1_4 = diag(gamma_sqr_1_4.^0.5);
    n_plus_1_4 = 0;
    n_minus_1_4 = 0;
    
    
    [ng,nng]=size(L_full);
    N_total_3 = ng/2;
    for i=1:2*N_total_3
        if real(gamma_1_4(i))+imag(gamma_1_4(i))<=0
            %n_plus_1_4 = n_plus_1_4+1;
        %else
            %n_minus_1_4 = n_minus_1_4 + 1;
            gamma_1_4(i) = -gamma_1_4(i);
        end
    end
    
    E_1_4 = L_EH*H_1_4/diag(gamma_1_4);
    %H_1_4 = diag(gamma_1_4)\L_HE*E_1_4;
    W_up = cat(2,E_1_4,E_1_4);
    W_down = cat(2,H_1_4,-H_1_4);
    W = cat(1,W_up,W_down);
    EH = W;
    
    gammaplus = gamma_1_4;
    gammaminus = -gamma_1_4;

  
    NN = N_total_3;
    pplusv = zeros(2*NN,1);
    pminusv = zeros(2*NN,1);
    for m=1:(2*NN)
        pplusv(m) = exp(1i*gammaplus(m)*h);
        pminusv(m) = exp(-1i*gammaminus(m)*h);
    end
    
    pplus = diag(pplusv);
    pminus = diag(pminusv);

    if (verbose>5)
        title = 'escape PMM-gamma'
    end
